!function(window){"use strict";function displayHtml(a){var b=document.getElementsByClassName("botdetect-captcha");if(0!==b.length){var c=b[0],d=c.getAttribute("data-stylename");d||(d="defaultCaptcha"),window.bdc_clientside_style_name=d;var e=commonFunctions.buildUrl(a.captchaEndpoint,{get:"html",c:d});helpers.ajax.get(e,function(b){if(200!==b.status)throw new Error("An error occurred while getting Captcha html markup.");var e=b.responseText,f=helpers.getBaseUrl(e),g=function(){c.innerHTML=e.replace(/<script.*<\/script>/g,""),commonFunctions.addInitScriptToBody(d,a.captchaEndpoint,f)};commonFunctions.addScriptToBody(a.captchaEndpoint,f,g)})}}var document=window.document,bodyElement=document.body||document.getElementsByTagName("body")[0],defaultSettings={captchaEndpoint:""};String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")});var helpers={extend:function(a,b){var c={};for(var d in b){var e=a[d];c[d]=void 0===e?b[d]:e}return c},ajax:{xhr:function(){var a=null;try{return a=new XMLHttpRequest}catch(a){}try{return a=new ActiveXObject("MSXML2.XMLHTTP.5.0")}catch(a){}try{return a=new ActiveXObject("MSXML2.XMLHTTP.4.0")}catch(a){}try{return a=new ActiveXObject("MSXML2.XMLHTTP.3.0")}catch(a){}try{return a=new ActiveXObject("MSXML2.XMLHTTP")}catch(a){}try{return a=new ActiveXObject("Microsoft.XMLHTTP")}catch(a){}return a},get:function(a,b){var c=this.xhr();c&&0===c.readyState&&(c.onreadystatechange=function(){4===c.readyState&&b(c)},c.open("GET",a,!0),c.send())}},parseJson:function(jsonString){var resultObj=null;return"undefined"!=typeof JSON&&"function"==typeof JSON.parse&&(resultObj=JSON.parse(jsonString)),resultObj||(resultObj=eval("("+jsonString+")")),resultObj},getBaseUrl:function(a){var b="",c=a.match(/id=['"]BDC_BaseUrl['"].*value=['"]([^'"]+)/);return c&&(b=c[1]),b}},commonFunctions={buildUrl:function(a,b){var c=[];for(var d in b)"string"==typeof d&&c.push(d+"="+b[d]);return/\?+/g.test(a)?a+"&"+c.join("&"):a+"?"+c.join("&")},scriptInclude:function(a,b,c){var d=document.createElement("script");return d.src=a,d.className=b,d.readyState?d.onreadystatechange=function(){"loaded"!==d.readyState&&"complete"!==d.readyState||"function"==typeof c&&c()}:d.onload=function(){"function"==typeof c&&c()},d},addScriptToBody:function(a,b,c){if(0===document.getElementsByClassName("BDC_ScriptInclude").length){var d=this.buildUrl(b+a,{get:"script-include"});bodyElement.appendChild(this.scriptInclude(d,"BDC_ScriptInclude",c))}},addInitScriptToBody:function(a,b,c,d){var e=document.getElementsByClassName("BDC_InitScriptInclude");0!==e.length&&e[0].parentNode.removeChild(e[0]);var f=document.getElementById("BDC_VCID_"+a);if(f){var g=this.buildUrl(c+b,{get:"init-script-include",c:a,t:f.value,cs:"2"});bodyElement.appendChild(this.scriptInclude(g,"BDC_InitScriptInclude",d))}}},Captcha=Captcha||{};Captcha.config=function(a){var b=helpers.extend(a||{},defaultSettings);b.captchaEndpoint=b.captchaEndpoint.replace(/\/+$/i,""),Captcha.init(b)},Captcha.init=function(a){Captcha.displayHtml(a)},Captcha.displayHtml=function(a){"complete"===document.readyState?displayHtml(a):document.onreadystatechange=function(){"complete"===document.readyState&&displayHtml(a)}},Captcha.validate=function(a){var b=!1,c=Captcha.getInstance();if(!c)throw new Error("BotDetect Captcha client-side instance does not exist.");var d=c.userInput.value.trim();if(!(d.length<1)){var e=c.validationUrl+"&i="+d;helpers.ajax.get(e,function(d){if(200!==d.status)throw new Error("An error occurred while validating Captcha.");b=helpers.parseJson(d.responseText),a(b),b||c.reloadImage()})}},Captcha.getInstance=function(){var a=window.bdc_clientside_style_name;return a?BotDetect.getInstanceByStyleName(a):null},window.Captcha=Captcha}(window);
//# sourceMappingURL=captcha-clientside-workflow.min.js.map